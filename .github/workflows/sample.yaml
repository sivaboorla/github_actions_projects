name: shell

on:
  push:
    branches:  [ master ]
  pull_request:
    branches: [ master ]
  #workflow_diapatch:
  



    
#Define the jobs    
jobs:
   shell_scripting:
     runs-on: ubuntu-latest 
     
     steps:
     - name: 'checkout repository on branch: ${{github.REF}}'
       uses: actions/checkout@v2
       continue-on-error: ${{ env.CONTINUE_ON_ERROR }}
       with:

           ref: ${{ github.REF }}
           fetch-depth: 0
     - name: Run shell script
       env:
         TOKEN: ${{ secrets.PASSWORD }}
         USER: ${{ secrets.USERNAME }}
       run: |
         all_repos="./repos.txt"
         for repo in $(cat $all_repos)
         do
           repo_folder=$(echo "$repo" | awk -F '[/.]' '{print $6}')
           echo "The repo folder is $repo_folder "
           git clone https://$USERNAME:$username@repo
           git clone -b master $repo
           cd $repo_folder
           rm -rf src
           git add .
           git commit -m "src folder deletion"
           git push origin master
         done



  
